# Requirements Document

## Introduction

이 문서는 식당 음성 기반 키오스크 AI 주문 시스템의 요구사항을 정의합니다. 이 시스템은 기존의 터치형 키오스크에 음성인식 시스템을 도입하여 완전히 음성으로만 구동되는 키오스크 서비스를 제공합니다. 시스템은 음성 전처리 → 음성인식 모델 → LLM → TTS의 파이프라인 구조로 설계되며, 특히 다중화자인식/구분 기술을 통해 노이즈가 있는 환경에서도 안정적인 서비스를 제공하는 것을 목표로 합니다.

## Requirements

### Requirement 1

**User Story:** 식당 고객으로서, 키오스크에 음성으로 주문을 말하면 시스템이 내 음성을 정확히 인식하여 텍스트로 변환해주기를 원한다.

#### Acceptance Criteria

1. WHEN 사용자가 키오스크에 음성으로 메뉴를 주문하면 THEN 시스템은 Whisper 기반 모델을 사용하여 음성을 텍스트로 변환해야 한다
2. WHEN 주변에 다른 사람의 목소리가 섞여 있을 때 THEN 시스템은 다중화자인식/구분 기술을 통해 주문자의 음성만을 분리하여 처리해야 한다
3. WHEN 음성 입력이 16kHz로 리샘플링되고 Log-Mel spectrogram으로 변환될 때 THEN 시스템은 (80, 3000) 크기의 특징 행렬을 생성해야 한다
4. WHEN 식당 도메인에 특화된 음성인식이 필요할 때 THEN 시스템은 AIHub 011 고객 응대 데이터의 식당 도메인(D50_J02)으로 파인튜닝된 모델을 사용해야 한다

### Requirement 2

**User Story:** 식당 고객으로서, 음성으로 주문, 변경, 취소, 결제 등의 다양한 의도를 표현했을 때 시스템이 내 의도를 정확히 파악하기를 원한다.

#### Acceptance Criteria

1. WHEN 사용자가 음성으로 주문 의도를 표현하면 THEN 시스템은 LLM을 통해 주문 의도를 파악하고 해당 메뉴 항목을 식별해야 한다
2. WHEN 사용자가 기존 주문을 변경하거나 취소하려고 하면 THEN 시스템은 변경/취소 의도를 파악하고 적절한 처리를 수행해야 한다
3. WHEN 사용자가 결제를 요청하면 THEN 시스템은 결제 의도를 파악하고 결제 프로세스를 시작해야 한다
4. WHEN 의도 파악 과정에서 THEN 시스템은 Tool calling을 활용하여 구조화된 출력을 생성하고 프롬프트를 최소화해야 한다

### Requirement 3

**User Story:** 식당 고객으로서, 시스템과 자연스러운 멀티턴 대화를 통해 주문을 완료하고 싶다.

#### Acceptance Criteria

1. WHEN 사용자가 초기 주문을 시작하면 THEN 시스템은 대화 컨텍스트를 유지하며 후속 질문이나 요청에 응답해야 한다
2. WHEN 사용자가 현재 주문 목록을 확인하려고 하면 THEN 시스템은 지금까지의 주문 내역을 정확히 제공해야 한다
3. WHEN 대화 중 사용자가 추가 주문이나 수정을 요청하면 THEN 시스템은 기존 주문 상태를 유지하면서 새로운 요청을 처리해야 한다
4. WHEN 대화가 진행될 때 THEN 시스템은 OpenAI GPT-4o 모델을 사용하여 자연스러운 응답을 생성해야 한다

### Requirement 4

**User Story:** 식당 고객으로서, 시스템의 응답을 음성으로 들어서 화면을 보지 않고도 주문 과정을 완료하고 싶다.

#### Acceptance Criteria

1. WHEN 시스템이 사용자에게 응답해야 할 때 THEN TTS 시스템을 통해 텍스트 응답을 음성으로 변환하여 출력해야 한다
2. WHEN 음성 응답이 생성될 때 THEN 자연스럽고 이해하기 쉬운 음성으로 출력되어야 한다
3. WHEN 주문 확인이나 결제 안내가 필요할 때 THEN 명확하고 정확한 음성 안내를 제공해야 한다
4. WHEN 오류나 재입력이 필요한 상황에서 THEN 적절한 음성 피드백을 제공해야 한다

### Requirement 5

**User Story:** 시스템 관리자로서, 다양한 식당 환경에서 시스템을 사용할 수 있도록 메뉴와 도메인을 쉽게 설정하고 관리하고 싶다.

#### Acceptance Criteria

1. WHEN 새로운 식당에서 시스템을 도입할 때 THEN 메뉴 정보를 JSON 설정 파일을 통해 쉽게 구성할 수 있어야 한다
2. WHEN 메뉴가 변경되거나 업데이트될 때 THEN 시스템 재시작 없이 설정을 반영할 수 있어야 한다
3. WHEN 다른 종류의 식당(한식, 중식, 양식 등)에 적용할 때 THEN 도메인별 특화 설정이 가능해야 한다
4. WHEN 시스템 성능을 모니터링할 때 THEN CER, WER 등의 메트릭을 통해 음성인식 성능을 측정할 수 있어야 한다

### Requirement 6

**User Story:** 개발자로서, 시스템의 각 컴포넌트(음성 전처리, 음성인식, LLM, TTS)를 독립적으로 개발하고 테스트할 수 있는 모듈화된 구조를 원한다.

#### Acceptance Criteria

1. WHEN 음성 전처리 모듈을 개발할 때 THEN AudioProcessor 클래스를 통해 다중화자인식/구분 기능을 독립적으로 구현할 수 있어야 한다
2. WHEN 음성인식 모듈을 개발할 때 THEN SpeechRecognizer 클래스를 통해 Whisper 모델을 독립적으로 활용할 수 있어야 한다
3. WHEN LLM 처리 모듈을 개발할 때 THEN IntentRecognizer와 DialogueManager 클래스를 통해 의도 파악과 대화 관리를 분리하여 구현할 수 있어야 한다
4. WHEN 각 모듈을 테스트할 때 THEN 단위 테스트와 통합 테스트를 독립적으로 수행할 수 있어야 한다